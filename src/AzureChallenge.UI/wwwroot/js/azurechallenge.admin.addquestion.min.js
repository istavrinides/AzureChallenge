$(document).ready(function(){var t=["Profile.UserNameHashed","Profile.SubscriptionId","Profile.TenantId"],n=[],r=[],i;$('[data-toggle="tooltip"]').tooltip();t.forEach(function(t){n.push(t)});$("#paramDataList option").each(function(){n.push($(this).val())});n.forEach(function(n){r.push({key:n,value:"{"+n+"}"})});i=new Tribute({values:r,selectTemplate:function(n){return n.original.value},trigger:"{",requireLeadingSpace:!1,noMatchTemplate:null});i.attach(document.getElementById("Text"));$("#Text").on("input",function(){var f=$(this).val().match(/\{([^}]+)\}/g),r,e,u;f&&!f.some(n=>n.slice(1,-1).includes("{")||n.slice(1,-1).includes("}"))&&(r=$("#textParamsInputGroup"),e=[],f?(r.empty(),u=0,f.forEach(function(f){f=f.slice(1,-1);n.includes(f)||(n.push(f),i.appendCurrent([{key:f,value:"{"+f+"}"}]));e.includes(f)||(e.push(f),f.startsWith("Profile.")?t.includes(f)?(r.append("<input type='hidden' name='TextParameters["+u+"]' id='TextParameters_"+u+"_' value='"+f+"' />"),r.append("<span class='btn btn-info m-1'>"+f+"<\/span>")):r.append("<span class='btn btn-danger m-1' data-toggle='tooltip' data-placement='top' title='The profile parameter "+f+" is not a valid Profile parameter and will not be included - please correct. Available values: "+t.join()+"'>"+f+"<\/span>"):(r.append("<input type='hidden' name='TextParameters["+u+"]' id='TextParameters_"+u+"_' value='"+f+"' />"),r.append("<span class='btn btn-info m-1'>"+f+"<\/span>")),u+=1)})):r.empty())});$("#uriTabContent").on("input",".uriinput",function(){var r=$(this).val().match(/\{([^}]+)\}/g),u;if(r&&!r.some(n=>n.slice(1,-1).includes("{")||n.slice(1,-1).includes("}"))){var s=$(this).attr("id"),e=parseInt($(this).data("index")),f=$("#"+s+"_params"),o=[];$(this).val().indexOf("documents.azure.com")>0&&(r.push("{ResourceGroupName}"),$(this).val().toLowerCase().endsWith("/offers")&&(r.push("{DatabaseName}"),r.push("{CollectionName}")),$(this).val().toLowerCase().indexOf("/docs/")>0&&r.push("{PartitionKey}"));r?(f.empty(),u=0,r.forEach(function(r){r=r.slice(1,-1);n.includes(r)||(n.push(r),i.appendCurrent([{key:r,value:"{"+r+"}"}]));o.includes(r)||(o.push(r),r.startsWith("Profile.")?t.includes(r)?(f.append("<input type='hidden' name='Uris["+e+"].UriParameters["+u+"]' id='Uris_"+e+"__UriParameters_"+u+"_' data-index='"+u+"' value='"+r+"' />"),f.append("<span class='btn btn-info m-1'>"+r+"<\/span>")):f.append("<span class='btn btn-danger m-1' data-toggle='tooltip' data-placement='top' title='The profile parameter "+r+" is not a valid Profile parameter and will not be included - please correct. Available values: "+t.join()+"'>"+r+"<\/span>"):(f.append("<input type='hidden' name='Uris["+e+"].UriParameters["+u+"]' id='Uris_"+e+"__UriParameters_"+u+"_' data-index='"+u+"' value='"+r+"' />"),f.append("<span class='btn btn-info m-1'>"+r+"<\/span>")),u+=1)})):f.empty()}});$("#uriTabContent").on("click",".btnRemoveUri",function(){var t=parseInt($(this).data("index")),i,n,r;for($("#uri-"+t+"-content").remove(),$("#uri-"+t+"-tab").remove(),$("#answer-"+t+"-tab").remove(),$("#answer-"+t+"-content").remove(),i=0,$("#uriTab a.uriNavItem").each(function(){var n=parseInt($(this).data("index"));n>i&&(i=n)}),n=t+1;n<i+1;n++)$("#uri-"+n+"-tab").attr("href","#uri-"+(n-1)+"-content"),$("#uri-"+n+"-tab").attr("aria-controls","uri-"+(n-1)+"-content"),$("#uri-"+n+"-tab").text("Uri #"+n),$("#uri-"+n+"-tab").attr("id","uri-"+(n-1)+"-tab"),$("#uri-"+n+"-content").attr("aria-labelledby","uri"+(n-1)+"-tab"),$("#uri-"+n+"-content").attr("id","uri-"+(n-1)+"-content"),$("#Uris_"+n+"__Id").attr("name","Uris["+(n-1)+"].Id"),$("#Uris_"+n+"__Id").val(n-1),$("#Uris_"+n+"__Id").attr("id","Uris_"+(n-1)+"__Id"),$("#Uris_"+n+"__Uri").attr("name","Uris["+(n-1)+"].Uri"),$("#Uris_"+n+"__Uri").attr("id","Uris_"+(n-1)+"__Uri"),$("Uris_"+n+"__CallType").attr("name","Uris["+(n-1)+"].CallType"),$("Uris_"+n+"__CallType").attr("id","Uris_"+(n-1)+"__CallType"),$("#Uris_"+n+"__Uri_params input").each(function(){var t=parseInt($(this).data("index"));$(this).attr("name","Uris["+(n-1)+"].UriParameters["+t+"]");$(this).attr("id","Uris_"+(n-1)+"__UriParameters_"+t+"_")}),$("#Uris_"+n+"__Uri_params").attr("id","Uris_"+(n-1)+"__Uri_params"),$("#Uris_"+n+"_Uri_remove").attr("id","Uris_"+(n-1)+"_Uri_remove"),$("button[data-index='"+n+"']").attr("data-index",n-1);r=0;r=t>i?t-1:t===i?i:t;$("#uri-"+r+"-tab").trigger("click")});$("#addUriLink").on("click",function(n){n.preventDefault();var t=0,r=!1;$("#uriTab a.uriNavItem").each(function(){r=!0;var n=parseInt($(this).data("index"));n>t&&(t=n)});r&&(t+=1);$(this).parent().before("<li class='nav-item'>                 <a class='nav-link uriNavItem' id='uri-"+t+"-tab' data-toggle='tab' href='#uri-"+t+"-content' role='tab' aria-controls='uri-"+t+"-content' aria-selected='false' data-index='"+t+"'> Uri #"+(t+1)+"<\/a>             <\/li>");$("#uriTabContent").append("<div class='tab-pane fade' id='uri-"+t+"-content' role='tabpanel' aria-labelledby='uri"+t+"-tab'>                 <input type='hidden' name='Uris["+t+"].Id' id='Uris_"+t+"__Id' value='"+t+"' />                 <div class='input-group mb-3'>                     <select class='selectpicker' name='Uris["+t+"].CallType' id='Uris_"+t+"__CallType'>                         <option selected>GET<\/option>                     <\/select >                     <input name='Uris["+t+"].Uri' id='Uris_"+t+"__Uri' data-index='"+t+"' class='form-control uriinput autocomplete' />                 <\/div >                 <small class='form-text text-muted'>Please enter the Uri for the API to call. Placeholders that will be replaced from below parameters should be wrapped inside curly braces {}.<\/small>                 <br />                 <div class='input-group mb-3' style='padding-left: 20px'>                     <input type='checkbox' name='Uris["+t+"].RequiresContributorAccess' id='Uris_"+t+"__RequiresContributorAccess' class='form-check-input' value='true' />                     <label class='form-check-label' for='Uris_"+t+"__RequiresContributorAccess'>Requires elevated (Contributor) access to the resource<\/label>                 <\/div >                 <div class='form-group'>                         <div class='col-md-12 pl-0' >                             <span>Discovered parameters:<\/span>                         <\/div >                     <div id='Uris_"+t+"__Uri_params' class='form-group row col-md-12'><\/div>                 <\/div>                 <div class= 'text-right'>                     <button type='button' class='btn btn-warning btnRemoveUri' id='Uris_"+t+"_Uri_remove' data-index='"+t+"'>Remove this Uri<\/button>                 <\/div >             <\/div>");$("#Uris_"+t+"__CallType").selectpicker();i.attach(document.getElementById("Uris_"+t+"__Uri"));r||$("#uri-0-tab").trigger("click")});$("#addLink").on("click",function(){var t=$("#inputNewLink").val(),n;if(!t){$("#inputNewLink").popover("show");return}n=$("#linksInputGroup input").length;$("#linksInputGroup").append("<input type='hidden' name='UsefulLinks["+n+"]' id='UsefulLinks_"+n+"_' data-index='"+n+"' value='"+t+"' />                     <span class='border border-info rounded p-1 bg-info m-1' data-index='"+n+"'>                         <a href='"+t+"' style='color:#fff !important'>"+t+"<\/a>&nbsp;                         <span class='badge badge-danger deleteLink' style='cursor:pointer' data-index='"+n+"'>&times<\/span>                     <\/span>")});$("#linksInputGroup").on("click",".deleteLink",function(){var n=parseInt($(this).attr("data-index"));$("#linksInputGroup input[data-index='"+n+"']").remove();$("#linksInputGroup span.border[data-index='"+n+"']").remove();$("#linksInputGroup input").each(function(){var t=$(this).attr("data-index");t>n&&($(this).attr("data-index",t-1),$(this).attr("id","UsefulLinks_"+(t-1)+"_"),$(this).attr("name","UsefulLinks["+(t-1)+"]"))});$("#linksInputGroup span").each(function(){var t=$(this).attr("data-index");t>n&&$(this).attr("data-index",t-1)})});$("form").submit(function(){$(this).valid()&&$("#waitModal").modal("show")})});